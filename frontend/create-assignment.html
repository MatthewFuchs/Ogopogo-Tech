<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Assignment</title>
    <link rel="stylesheet" href="css/assignment.css"> <!-- Ensure correct path -->
</head>
<body>

<main>
    <div class="container" id="createAssignmentForm">
        <h2>Create New Assignment</h2>
        <form id="assignmentForm">
            <div class="form-group">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required class="form-control">
            </div>
            <div class="form-group">
                <label for="description">Description:</label>
                <textarea id="description" name="description" required class="form-control"></textarea>
            </div>
            <div class="form-group">
                <label for="type">Type:</label>
                <select id="type" name="type" required class="form-control">
                    <option value="">--Select Type--</option>
                    <option value="multiquestion">Multi Question</option>
                    <option value="essay">Essay</option>
                    <option value="mcq">MCQ</option>
                </select>
            </div>
            <div class="form-group">
                <label for="courseID">Course ID:</label>
                <input type="text" id="courseID" name="courseID" required class="form-control">
            </div>
            <button type="submit" class="btn-explore">Create Assignment</button>
        </form>
    </div>
</main>

<script>
    const assignmentForm = document.getElementById('assignmentForm');
    assignmentForm.addEventListener('submit', (event) => {
        event.preventDefault();

        const formData = {
            title: document.getElementById('title').value,
            description: document.getElementById('description').value,
            type: document.getElementById('type').value,
            courseID: document.getElementById('courseID').value
        }

        let token = localStorage.getItem('userToken');
        if (!token) {
            token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY2MDBlOTgxOTZjMmRkNTQxY2ZmYzdlNyIsImlhdCI6MTcxMTMzNTgwOSwiZXhwIjoxNzEzOTI3ODA5fQ.UFgAtXOeg1r7j-4Ug5DOgN_EG1gqbjNkihJMKeC9mXY'
        }

        fetch('http://localhost:8080/api/assignments/', {
            method: 'POST',
            headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
            body: JSON.stringify(formData),
            user: {
                id: '6600e98196c2dd541cffc7e7'
            }
        })
        .then(response => {
            alert('Assignment created successfully!');
            window.location.reload();
        })
        .catch(error => {
            alert('Error! Assignment creation not succesful');
            console.error(error);
        });
    });
</script>

</body>
</html>
